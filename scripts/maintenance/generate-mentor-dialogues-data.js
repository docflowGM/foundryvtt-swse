/**
 * scripts/maintenance/generate-mentor-dialogues-data.js
 *
 * Generates a pure-data JS module from data/mentor-dialogues.json.
 *
 * Why:
 * - Keeps dialogue authored as JSON (content)
 * - Preserves synchronous imports at runtime (no async fetch)
 *
 * Usage:
 *   node scripts/maintenance/generate-mentor-dialogues-data.js
 */
import fs from "node:fs";
import path from "node:path";
import { fileURLToPath } from "node:url";

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const repoRoot = path.resolve(__dirname, "..", "..");
const inputPath = path.join(repoRoot, "data", "mentor-dialogues.json");
const outputPath = path.join(repoRoot, "scripts", "apps", "mentor-dialogues.data.js");

function main() {
  const raw = fs.readFileSync(inputPath, "utf8");
  const parsed = JSON.parse(raw);

  if (!parsed || typeof parsed !== "object" || !parsed.mentors || typeof parsed.mentors !== "object") {
    throw new Error("mentor-dialogues.json must be { version, mentors: { ... } }");
  }

  const mentors = parsed.mentors;

  const output = [
    "/**",
    " * AUTO-GENERATED FILE â€” DO NOT EDIT.",
    " * Source of truth: data/mentor-dialogues.json",
    " * Generated by: scripts/maintenance/generate-mentor-dialogues-data.js",
    " */",
    "",
    "export const MENTORS = " + JSON.stringify(mentors, null, 2) + ";",
    ""
  ].join("\n");

  fs.writeFileSync(outputPath, output, "utf8");
  // eslint-disable-next-line no-console
  console.log(`[generate-mentor-dialogues-data] Wrote ${outputPath}`);
}

main();
