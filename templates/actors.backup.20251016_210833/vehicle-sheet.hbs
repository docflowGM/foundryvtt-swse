{{!-- SWSE Vehicle Sheet - Roll20 Inspired Design --}}
{{!-- File: templates/actors/vehicle-sheet.hbs --}}

<form class="swse vehicle-sheet {{cssClass}} holo-theme" autocomplete="off">
    {{!-- Header Section --}}
    <header class="sheet-header">
        <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100" width="100"/>
        
        <div class="header-fields">
            <h1 class="charname">
                <input name="name" type="text" value="{{actor.name}}" placeholder="Vehicle Name"/>
            </h1>
            
            <div class="header-row">
                <div class="resource">
                    <label class="resource-label">Type</label>
                    <select name="system.vehicleType">
                        <option value="starfighter" {{#if (eq system.vehicleType "starfighter")}}selected{{/if}}>Starfighter</option>
                        <option value="transport" {{#if (eq system.vehicleType "transport")}}selected{{/if}}>Transport</option>
                        <option value="capital" {{#if (eq system.vehicleType "capital")}}selected{{/if}}>Capital Ship</option>
                        <option value="speeder" {{#if (eq system.vehicleType "speeder")}}selected{{/if}}>Speeder</option>
                        <option value="walker" {{#if (eq system.vehicleType "walker")}}selected{{/if}}>Walker</option>
                    </select>
                </div>
                
                <div class="resource">
                    <label class="resource-label">Size</label>
                    <select name="system.size">
                        <option value="colossal" {{#if (eq system.size "colossal")}}selected{{/if}}>Colossal</option>
                        <option value="gargantuan" {{#if (eq system.size "gargantuan")}}selected{{/if}}>Gargantuan</option>
                        <option value="huge" {{#if (eq system.size "huge")}}selected{{/if}}>Huge</option>
                        <option value="large" {{#if (eq system.size "large")}}selected{{/if}}>Large</option>
                    </select>
                </div>
                
                <div class="resource">
                    <label class="resource-label">Cost</label>
                    <input type="number" name="system.cost" value="{{system.cost}}" data-dtype="Number" placeholder="Credits"/>
                </div>
            </div>
        </div>
    </header>

    {{!-- Main Tabs --}}
    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item active" data-tab="stats">Stats</a>
        <a class="item" data-tab="crew">Crew</a>
        <a class="item" data-tab="weapons">Weapons</a>
        <a class="item" data-tab="cargo">Cargo</a>
        <a class="item" data-tab="notes">Notes</a>
    </nav>

    <section class="sheet-body">
        {{!-- Stats Tab --}}
        <div class="tab stats active" data-group="primary" data-tab="stats">
            <div class="vehicle-stats-grid">
                {{!-- Combat Stats --}}
                <div class="vehicle-combat">
                    <h3 class="section-header">Combat Statistics</h3>
                    
                    <div class="stat-row">
                        <label>Hull Points</label>
                        <div class="stat-input">
                            <input type="number" name="system.hull.value" value="{{system.hull.value}}" data-dtype="Number" style="width: 80px;"/>
                            <span>/</span>
                            <input type="number" name="system.hull.max" value="{{system.hull.max}}" data-dtype="Number" style="width: 80px;"/>
                        </div>
                    </div>
                    
                    <div class="stat-row">
                        <label>Shield Rating</label>
                        <div class="stat-input">
                            <input type="number" name="system.shields.value" value="{{system.shields.value}}" data-dtype="Number" style="width: 80px;"/>
                            <span>/</span>
                            <input type="number" name="system.shields.max" value="{{system.shields.max}}" data-dtype="Number" style="width: 80px;"/>
                        </div>
                    </div>
                    
                    <div class="stat-row">
                        <label>Damage Reduction</label>
                        <input type="number" name="system.damageReduction" value="{{system.damageReduction}}" data-dtype="Number" style="width: 80px;"/>
                    </div>
                    
                    <h3 class="section-header">Defenses</h3>
                    
                    <div class="vehicle-defenses">
                        <div class="defense-stat">
                            <label>Reflex Defense</label>
                            <div class="def-value">{{system.defenses.reflex.total}}</div>
                        </div>
                        <div class="defense-stat">
                            <label>Fortitude Defense</label>
                            <div class="def-value">{{system.defenses.fortitude.total}}</div>
                        </div>
                    </div>
                </div>

                {{!-- Movement & Systems --}}
                <div class="vehicle-systems">
                    <h3 class="section-header">Movement</h3>
                    
                    <div class="stat-row">
                        <label>Speed (Squares/Round)</label>
                        <input type="number" name="system.speed.tactical" value="{{system.speed.tactical}}" data-dtype="Number"/>
                    </div>
                    
                    <div class="stat-row">
                        <label>Max Velocity</label>
                        <input type="text" name="system.speed.maxVelocity" value="{{system.speed.maxVelocity}}" placeholder="e.g., 1050 km/h"/>
                    </div>
                    
                    <div class="stat-row">
                        <label>Hyperdrive Rating</label>
                        <input type="text" name="system.hyperdrive" value="{{system.hyperdrive}}" placeholder="e.g., x1, x2"/>
                    </div>
                    
                    <h3 class="section-header">Capacity</h3>
                    
                    <div class="stat-row">
                        <label>Crew</label>
                        <input type="text" name="system.crew.required" value="{{system.crew.required}}" placeholder="e.g., 1-2"/>
                    </div>
                    
                    <div class="stat-row">
                        <label>Passengers</label>
                        <input type="number" name="system.passengers" value="{{system.passengers}}" data-dtype="Number"/>
                    </div>
                    
                    <div class="stat-row">
                        <label>Cargo (kg)</label>
                        <input type="number" name="system.cargo.capacity" value="{{system.cargo.capacity}}" data-dtype="Number"/>
                    </div>
                    
                    <div class="stat-row">
                        <label>Consumables</label>
                        <input type="text" name="system.consumables" value="{{system.consumables}}" placeholder="e.g., 2 months"/>
                    </div>
                </div>
            </div>
        </div>

        {{!-- Crew Tab --}}
        <div class="tab crew" data-group="primary" data-tab="crew">
            <h3 class="section-header">Crew Positions</h3>
            
            <div class="crew-positions">
                <div class="crew-slot">
                    <label>Pilot</label>
                    <input type="text" name="system.crew.pilot" value="{{system.crew.pilot}}" placeholder="Drag actor or enter name"/>
                    <div class="crew-stats" data-position="pilot">
                        <button type="button" class="roll-pilot"><i class="fas fa-dice-d20"></i> Pilot Check</button>
                    </div>
                </div>
                
                <div class="crew-slot">
                    <label>Co-Pilot</label>
                    <input type="text" name="system.crew.copilot" value="{{system.crew.copilot}}" placeholder="Drag actor or enter name"/>
                </div>
                
                <div class="crew-slot">
                    <label>Gunner(s)</label>
                    <input type="text" name="system.crew.gunners" value="{{system.crew.gunners}}" placeholder="Number or names"/>
                </div>
                
                <div class="crew-slot">
                    <label>Engineer</label>
                    <input type="text" name="system.crew.engineer" value="{{system.crew.engineer}}" placeholder="Drag actor or enter name"/>
                    <div class="crew-stats" data-position="engineer">
                        <button type="button" class="roll-mechanics"><i class="fas fa-dice-d20"></i> Mechanics Check</button>
                    </div>
                </div>
                
                <div class="crew-slot">
                    <label>System Operator</label>
                    <input type="text" name="system.crew.operator" value="{{system.crew.operator}}" placeholder="Drag actor or enter name"/>
                </div>
            </div>
        </div>

        {{!-- Weapons Tab --}}
        <div class="tab weapons" data-group="primary" data-tab="weapons">
            <h3 class="section-header">Vehicle Weapons</h3>
            <button type="button" class="add-vehicle-weapon"><i class="fas fa-plus"></i> Add Weapon System</button>
            
            <div class="vehicle-weapons-list">
                {{#each system.vehicleWeapons as |weapon index|}}
                <div class="vehicle-weapon" data-index="{{index}}">
                    <div class="weapon-header">
                        <input type="text" name="system.vehicleWeapons.{{index}}.name" value="{{weapon.name}}" placeholder="Weapon Name"/>
                        <button type="button" class="remove-vehicle-weapon" data-index="{{index}}"><i class="fas fa-trash"></i></button>
                    </div>
                    <div class="weapon-stats-grid">
                        <div>
                            <label>Damage</label>
                            <input type="text" name="system.vehicleWeapons.{{index}}.damage" value="{{weapon.damage}}" placeholder="e.g., 5d10x2"/>
                        </div>
                        <div>
                            <label>Range</label>
                            <input type="text" name="system.vehicleWeapons.{{index}}.range" value="{{weapon.range}}" placeholder="e.g., Close"/>
                        </div>
                        <div>
                            <label>Fire Arc</label>
                            <select name="system.vehicleWeapons.{{index}}.arc">
                                <option value="forward" {{#if (eq weapon.arc "forward")}}selected{{/if}}>Forward</option>
                                <option value="aft" {{#if (eq weapon.arc "aft")}}selected{{/if}}>Aft</option>
                                <option value="port" {{#if (eq weapon.arc "port")}}selected{{/if}}>Port</option>
                                <option value="starboard" {{#if (eq weapon.arc "starboard")}}selected{{/if}}>Starboard</option>
                                <option value="turret" {{#if (eq weapon.arc "turret")}}selected{{/if}}>Turret (360Â°)</option>
                            </select>
                        </div>
                        <div>
                            <label>Attack Bonus</label>
                            <input type="number" name="system.vehicleWeapons.{{index}}.attackBonus" value="{{weapon.attackBonus}}" data-dtype="Number"/>
                        </div>
                    </div>
                    <button type="button" class="fire-vehicle-weapon rollable" data-index="{{index}}"><i class="fas fa-crosshairs"></i> Fire Weapon</button>
                </div>
                {{/each}}
            </div>
        </div>

        {{!-- Cargo Tab --}}
        <div class="tab cargo" data-group="primary" data-tab="cargo">
            <h3 class="section-header">Cargo Hold</h3>
            
            <div class="cargo-capacity">
                <label>Capacity:</label>
                <span><strong>{{system.cargo.current}}</strong> / {{system.cargo.capacity}} kg</span>
            </div>
            
            <div class="cargo-items">
                {{#each items}}
                {{#if (eq this.type "equipment")}}
                <div class="cargo-item" data-item-id="{{this._id}}">
                    <div class="item-name">{{this.name}}</div>
                    <div class="item-quantity">Qty: {{this.system.quantity}}</div>
                    <div class="item-weight">{{this.system.weight}} kg</div>
                </div>
                {{/if}}
                {{/each}}
            </div>
        </div>

        {{!-- Notes Tab --}}
        <div class="tab notes" data-group="primary" data-tab="notes">
            <h3 class="section-header">Vehicle Description</h3>
            {{editor system.description target="system.description" button=true owner=owner editable=editable}}
            
            <h3 class="section-header">Modifications</h3>
            {{editor system.modifications target="system.modifications" button=true owner=owner editable=editable}}
        </div>
    </section>
</form>
