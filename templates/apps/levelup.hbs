<div class="swse-levelup">
  <header class="levelup-header">
    <h2>Level Up: {{actor.name}}</h2>
    <div class="level-indicator">
      <span>Current Level: <strong>{{currentLevel}}</strong></span>
      <i class="fas fa-arrow-right"></i>
      <span>New Level: <strong>{{newLevel}}</strong></span>
    </div>
  </header>

  {{!-- MENTOR NARRATION PANEL --}}
  {{#if mentor}}
  <aside class="mentor-panel">
    <div class="mentor-header">
      <div class="mentor-info">
        <h4>{{mentor.name}}</h4>
        <span class="mentor-title">{{mentor.title}}</span>
      </div>
      <div class="mentor-portrait">
        <img src="{{mentor.portrait}}" alt="{{mentor.name}}" onerror="this.style.display='none'" />
      </div>
    </div>
    <div class="mentor-message">
      <div class="mentor-greeting">
        <i class="fas fa-quote-left"></i>
        <p>{{mentorGreeting}}</p>
        <i class="fas fa-quote-right"></i>
      </div>
      {{#if mentorGuidance}}
      <div class="mentor-guidance">
        <i class="fas fa-lightbulb"></i>
        <p>{{mentorGuidance}}</p>
      </div>
      {{/if}}
    </div>
  </aside>
  {{/if}}

  <main class="levelup-body">

    {{!-- STEP 0A: SPECIES SELECTION (Level 0 only) --}}
    {{#if (eq currentStep "species")}}
    <section class="step-species-selection">
      <h3>Choose Your Species</h3>
      <p class="hint">Select the species for your character. Each species grants unique bonuses and abilities.</p>

      <div class="species-grid">
        {{#each availableSpecies}}
        <div class="species-card">
          <h5>{{this.name}}</h5>
          {{#if this.system.size}}
          <div class="species-size">
            <span class="size-label">Size: {{this.system.size}}</span>
          </div>
          {{/if}}
          <div class="species-bonuses">
            {{#if this.system.abilities}}
            <span class="bonus-label">{{this.system.abilities}}</span>
            {{/if}}
          </div>
          {{#if this.system.skillBonuses}}
          <div class="skill-bonuses">
            {{#each this.system.skillBonuses}}
            <span class="skill-bonus">{{this}}</span>
            {{/each}}
          </div>
          {{/if}}
          {{#if this.system.special}}
          <div class="special-abilities">
            {{#each this.system.special}}
            <span class="special-ability">{{this}}</span>
            {{/each}}
          </div>
          {{/if}}
          <button class="select-species-btn btn-primary" data-species-id="{{this._id}}" data-species-name="{{this.name}}">
            <i class="fas fa-dna"></i> Select
          </button>
        </div>
        {{/each}}
      </div>
    </section>
    {{/if}}

    {{!-- STEP 0B: ATTRIBUTES SELECTION (Level 0 only) --}}
    {{#if (eq currentStep "attributes")}}
    <section class="step-attributes-selection">
      <h3>Set Your Ability Scores</h3>
      <p class="hint">Determine your character's base ability scores using the point-buy system or rolling dice.</p>

      {{!-- Reuse the ability generation UI from chargen --}}
      <div class="ability-methods">
        <button type="button" id="pb-init" class="method-button active">
          <i class="fas fa-calculator"></i> Point Buy (32 points)
        </button>
        <button type="button" id="std-roll-btn" class="method-button">
          <i class="fas fa-dice"></i> Standard Roll (4d6 drop lowest)
        </button>
        <button type="button" id="org-roll-btn" class="method-button">
          <i class="fas fa-dice-d20"></i> Organic Roll (24d6)
        </button>
      </div>

      <div id="point-mode" class="ability-mode">
        <div class="points-remaining">
          Points Remaining: <strong><span id="point-remaining">32</span></strong>
        </div>
        <div class="abilities-grid">
          <div class="ability-card">
            <label>STR</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="str">−</button>
              <input name="ability_str" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="str">+</button>
            </div>
            <div id="display_str" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
          <div class="ability-card">
            <label>DEX</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="dex">−</button>
              <input name="ability_dex" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="dex">+</button>
            </div>
            <div id="display_dex" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
          <div class="ability-card">
            <label>CON</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="con">−</button>
              <input name="ability_con" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="con">+</button>
            </div>
            <div id="display_con" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
          <div class="ability-card">
            <label>INT</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="int">−</button>
              <input name="ability_int" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="int">+</button>
            </div>
            <div id="display_int" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
          <div class="ability-card">
            <label>WIS</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="wis">−</button>
              <input name="ability_wis" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="wis">+</button>
            </div>
            <div id="display_wis" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
          <div class="ability-card">
            <label>CHA</label>
            <div class="ability-controls">
              <button type="button" class="ability-btn" data-minus="cha">−</button>
              <input name="ability_cha" class="ability-input" type="number" value="8" min="8" max="18" />
              <button type="button" class="ability-btn" data-plus="cha">+</button>
            </div>
            <div id="display_cha" class="ability-display">Total: 8 (Mod: -1)</div>
          </div>
        </div>
      </div>

      <div id="standard-mode" class="ability-mode" style="display:none;">
        <div id="roll-results" class="roll-results"></div>
        <p class="hint">Click a roll value, then click an ability to assign it.</p>
      </div>

      <div id="organic-mode" class="ability-mode" style="display:none;">
        <div id="organic-groups" class="organic-groups"></div>
        <p class="hint">Click a group, then click an ability to assign the total.</p>
      </div>

      <div class="form-actions">
        <button type="button" class="confirm-attributes-btn btn-primary">
          Confirm Attributes <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </section>
    {{/if}}

    {{!-- STEP 1: CLASS SELECTION --}}
    {{#if (eq currentStep "class")}}
    <section class="step-class-selection">
      <h3>Choose Your Class</h3>
      <p class="hint">Select a class to add to your character. Base classes can be taken multiple times for multi-classing.</p>

      <div class="current-classes">
        <h4>Current Classes:</h4>
        {{#each characterClasses}}
          <span class="class-badge">{{@key}} ({{this}})</span>
        {{else}}
          <span class="empty">No classes yet</span>
        {{/each}}
      </div>

      <div class="class-categories">
        <h4>Base Classes</h4>
        <div class="class-grid">
          {{#each availableClasses}}
            {{#if this.isBase}}
            <div class="class-card">
              <h5>{{this.name}}</h5>
              <div class="class-stats">
                <span>Hit Die: d{{this.system.hitDie}}</span>
                <span>BAB: +{{this.system.babProgression}}</span>
                <span>Skills: {{this.system.trainedSkills}}</span>
              </div>
              <button class="select-class-btn btn-primary" data-class-id="{{this.id}}">
                <i class="fas fa-user-plus"></i> Select
              </button>
            </div>
            {{/if}}
          {{/each}}
        </div>

        <h4>Prestige Classes</h4>
        <div class="class-grid">
          {{#each availableClasses}}
            {{#if this.isPrestige}}
            <div class="class-card prestige">
              <h5>{{this.name}}</h5>
              <div class="class-stats">
                <span>Hit Die: d{{this.system.hitDie}}</span>
                <span>BAB: +{{this.system.babProgression}}</span>
                <span class="prestige-label">Prestige</span>
              </div>
              <button class="select-class-btn btn-primary" data-class-id="{{this.id}}">
                <i class="fas fa-star"></i> Select
              </button>
            </div>
            {{/if}}
          {{/each}}
        </div>
      </div>
    </section>
    {{/if}}

    {{!-- STEP 2: MULTICLASS BONUS --}}
    {{#if (eq currentStep "multiclass-bonus")}}
    <section class="step-multiclass-bonus">
      <h3>Multi-class Bonus</h3>
      <p class="hint">You are taking a second base class! Choose your bonus (you can always choose feat OR skill):</p>

      <div class="multiclass-choice">
        {{#unless (eq multiclassBonusChoice "all_feats")}}
        <div class="bonus-options">
          <div class="bonus-option">
            <h4>Choose ONE Starting Feat</h4>
            <div class="feat-selection">
              {{#each selectedClass.system.startingFeatures}}
                {{#if (eq this.type "feat_grant")}}
                <button class="select-feat-btn choice-button" data-feat-id="{{this.name}}">
                  <i class="fas fa-star"></i> {{this.name}}
                </button>
                {{/if}}
              {{/each}}
            </div>
          </div>

          <div class="bonus-option-divider">
            <span>OR</span>
          </div>

          <div class="bonus-option">
            <h4>Choose ONE Trained Skill</h4>
            <div class="skill-selection">
              {{#each selectedClass.system.classSkills}}
              <button class="select-skill-btn choice-button" data-skill="{{this}}">
                <i class="fas fa-check-circle"></i> {{this}}
              </button>
              {{/each}}
            </div>
          </div>
        </div>
        {{/unless}}

        {{#if (eq multiclassBonusChoice "all_feats")}}
        <p>You will receive ALL starting feats from {{selectedClass.name}}!</p>
        <button class="next-step btn-primary">
          Continue <i class="fas fa-arrow-right"></i>
        </button>
        {{/if}}
      </div>
    </section>
    {{/if}}

    {{!-- STEP 3: ABILITY SCORE INCREASES --}}
    {{#if (eq currentStep "ability-increase")}}
    <section class="step-ability-increase">
      <h3>Ability Score Increase</h3>
      <p class="hint">
        At level {{newLevel}}, you gain +2 ability score points to allocate.
        {{#if (eq abilityIncreaseMethod "flexible")}}
          <br><strong>Flexible Method:</strong> You can apply 2 points to ONE attribute OR 1 point to TWO attributes.
        {{else}}
          <br><strong>Standard Method:</strong> You must apply 1 point to TWO different attributes.
        {{/if}}
      </p>

      <div class="ability-increase-grid">
        {{#each actor.system.abilities}}
        <div class="ability-increase-card">
          <h4>{{@key}}</h4>
          <div class="ability-current">
            <span>Current: {{this.base}}</span>
            <span>Mod: {{#if (gte this.mod 0)}}+{{/if}}{{this.mod}}</span>
          </div>
          <button class="ability-increase-btn btn-primary" data-ability="{{@key}}">
            <i class="fas fa-plus-circle"></i> Add +1
          </button>
          {{#if (lookup ../abilityIncreases @key)}}
          <div class="ability-allocated">
            +{{lookup ../abilityIncreases @key}} allocated
          </div>
          {{/if}}
        </div>
        {{/each}}
      </div>

      <div class="ability-progress">
        <p>Points Allocated: <strong>{{#each abilityIncreases}}{{this}}{{#unless @last}}+{{/unless}}{{/each}} / 2</strong></p>
      </div>

      <div class="form-actions">
        <button class="prev-step btn-secondary">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button class="next-step btn-primary">
          Continue <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </section>
    {{/if}}

    {{!-- STEP 4: FEAT SELECTION --}}
    {{#if (eq currentStep "feat")}}
    <section class="step-feat-selection">
      <h3>Select a Bonus Feat</h3>
      <p class="hint">At level {{newLevel}}, you gain a bonus feat. Choose one that fits your character concept.</p>

      <div class="feat-selection-grid">
        {{#each availableFeats}}
        <div class="feat-card {{#if (find ../selectedFeats '_id' this._id)}}selected{{/if}}">
          <h4>{{this.name}}</h4>
          <div class="feat-description">{{this.system.benefit}}</div>
          {{#if this.system.prerequisites}}
          <div class="feat-prereqs"><strong>Prerequisites:</strong> {{this.system.prerequisites}}</div>
          {{/if}}
          <button class="select-bonus-feat choice-button" data-feat-id="{{this._id}}">
            <i class="fas fa-star"></i> Select
          </button>
        </div>
        {{/each}}
      </div>

      {{#if selectedFeats}}
      <div class="selected-feats-display">
        <h4>Selected Feats:</h4>
        {{#each selectedFeats}}
        <div class="selected-feat">
          <strong>{{this.name}}</strong> - {{this.system.benefit}}
        </div>
        {{/each}}
      </div>
      {{/if}}

      <div class="form-actions">
        <button class="prev-step btn-secondary">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button class="next-step btn-primary">
          Continue <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </section>
    {{/if}}

    {{!-- STEP 5: TALENT SELECTION --}}
    {{#if (eq currentStep "talent")}}
    <section class="step-talent-selection">
      <h3>Select a Talent</h3>
      <p class="hint">
        {{#if (eq talentTreeRestriction "current")}}
          Choose a talent tree from {{selectedClass.name}}
        {{else}}
          Choose a talent tree from any of your classes
        {{/if}}
      </p>

      <div class="talent-selection-intro">
        <div class="talent-intro-card">
          <div class="talent-intro-icon">
            <i class="fas fa-project-diagram"></i>
          </div>
          <h4>Explore Talent Trees</h4>
          <p>View an interactive visualization of available talent trees. Hover to preview, click to explore in detail.</p>
          <button class="select-talent-tree btn-primary-large">
            <i class="fas fa-search-plus"></i>
            Browse Talent Trees
          </button>
        </div>

        {{#if talentTrees}}
        <div class="quick-tree-buttons">
          <p class="quick-select-label">Or quickly select a tree:</p>
          <div class="talent-tree-grid">
            {{#each talentTrees}}
            <button class="select-talent-tree choice-button" data-tree="{{this}}">
              <i class="fas fa-tree"></i>
              <span>{{this}}</span>
            </button>
            {{/each}}
          </div>
        </div>
        {{/if}}
      </div>

      <div class="selected-talent-display">
        {{#if selectedTalent}}
        <div class="selected-talent-card">
          <i class="fas fa-check-circle"></i>
          <h4>Selected: {{selectedTalent.name}}</h4>
          <p>{{selectedTalent.system.benefit}}</p>
        </div>
        {{/if}}
      </div>

      <div class="form-actions">
        <button class="prev-step btn-secondary">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button class="next-step btn-primary">
          Continue <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </section>
    {{/if}}

    {{!-- STEP 5: SUMMARY --}}
    {{#if (eq currentStep "summary")}}
    <section class="step-summary">
      <h3>Level Up Summary</h3>

      <div class="summary-grid">
        <div class="summary-section">
          <h4>Class</h4>
          <p><strong>{{selectedClass.name}}</strong></p>
          <p>Hit Die: d{{selectedClass.system.hitDie}}</p>
        </div>

        <div class="summary-section">
          <h4>HP Gain</h4>
          <p><strong>+{{hpGain}} HP</strong></p>
          <p>New Total: {{add actor.system.hp.max hpGain}}</p>
        </div>

        {{#if selectedTalent}}
        <div class="summary-section">
          <h4>Talent</h4>
          <p><strong>{{selectedTalent.name}}</strong></p>
        </div>
        {{/if}}

        {{#if selectedFeats}}
        <div class="summary-section">
          <h4>Feats</h4>
          {{#each selectedFeats}}
          <p>{{this.name}}</p>
          {{/each}}
        </div>
        {{/if}}

        {{#if selectedSkills}}
        <div class="summary-section">
          <h4>Trained Skills</h4>
          {{#each selectedSkills}}
          <p>{{this}}</p>
          {{/each}}
        </div>
        {{/if}}
      </div>

      <div class="form-actions">
        <button class="prev-step btn-secondary">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button class="complete-levelup btn-success">
          <i class="fas fa-check"></i> Complete Level Up
        </button>
      </div>
    </section>
    {{/if}}

  </main>
</div>

<style>
.swse-levelup {
  font-family: "Roboto", Arial, sans-serif;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: #e4e4e4;
  border-radius: 8px;
}

.levelup-header {
  background: rgba(0, 0, 0, 0.3);
  padding: 1.5rem;
  border-bottom: 2px solid #0a74da;
  text-align: center;
}

.levelup-header h2 {
  margin: 0 0 0.5rem 0;
  color: #00d9ff;
}

.level-indicator {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  font-size: 1.1rem;
}

.level-indicator i {
  color: #00d9ff;
}

/* MENTOR PANEL STYLES */
.mentor-panel {
  background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(10, 116, 218, 0.1) 100%);
  border-left: 4px solid #00d9ff;
  border-right: 4px solid #0a74da;
  padding: 1.5rem;
  margin: 0;
}

.mentor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.mentor-info h4 {
  margin: 0;
  color: #00d9ff;
  font-size: 1.3rem;
  font-weight: bold;
}

.mentor-title {
  color: #aaa;
  font-size: 0.9rem;
  font-style: italic;
}

.mentor-portrait {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 3px solid #00d9ff;
  overflow: hidden;
}

.mentor-portrait img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.mentor-message {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.mentor-greeting {
  position: relative;
  padding: 1rem 1.5rem;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  border-left: 3px solid #00d9ff;
  font-style: italic;
  line-height: 1.6;
}

.mentor-greeting p {
  margin: 0;
  color: #fff;
  font-size: 1.05rem;
}

.mentor-greeting .fa-quote-left {
  position: absolute;
  top: 0.5rem;
  left: 0.5rem;
  color: rgba(0, 217, 255, 0.3);
  font-size: 1.5rem;
}

.mentor-greeting .fa-quote-right {
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;
  color: rgba(0, 217, 255, 0.3);
  font-size: 1.5rem;
}

.mentor-guidance {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  background: rgba(255, 193, 7, 0.1);
  border-radius: 6px;
  border-left: 3px solid #ffc107;
}

.mentor-guidance i {
  color: #ffc107;
  font-size: 1.2rem;
}

.mentor-guidance p {
  margin: 0;
  color: #f0f0f0;
  font-size: 0.95rem;
}

.levelup-body {
  padding: 2rem;
  min-height: 400px;
}

.hint {
  text-align: center;
  color: #aaa;
  font-style: italic;
  margin-bottom: 1.5rem;
}

.current-classes {
  margin-bottom: 2rem;
  padding: 1rem;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 6px;
}

.class-badge {
  display: inline-block;
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, #0a74da 0%, #0056b3 100%);
  border-radius: 4px;
  margin: 0.25rem;
  font-weight: bold;
}

.class-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}

.class-card {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  transition: all 0.3s;
}

.class-card:hover {
  background: rgba(10, 116, 218, 0.2);
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(10, 116, 218, 0.3);
}

.class-card.prestige {
  border-color: #ffd700;
}

.class-card h5 {
  margin: 0 0 0.5rem 0;
  color: #00d9ff;
  font-size: 1.1rem;
}

.class-stats {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  margin-bottom: 1rem;
  font-size: 0.9rem;
}

.prestige-label {
  color: #ffd700;
  font-weight: bold;
}

.choice-button {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  color: #fff;
  cursor: pointer;
  transition: all 0.3s;
  text-align: center;
}

.choice-button:hover {
  background: rgba(10, 116, 218, 0.2);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(10, 116, 218, 0.4);
}

.bonus-options {
  display: flex;
  gap: 2rem;
  align-items: flex-start;
}

.bonus-option {
  flex: 1;
}

.bonus-option h4 {
  color: #00d9ff;
  margin-bottom: 1rem;
  text-align: center;
}

.bonus-option-divider {
  display: flex;
  align-items: center;
  padding-top: 3rem;
}

.bonus-option-divider span {
  padding: 0.5rem 1rem;
  background: rgba(0, 217, 255, 0.2);
  border: 2px solid #00d9ff;
  border-radius: 50%;
  font-weight: bold;
  color: #00d9ff;
}

.feat-selection, .skill-selection {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.ability-increase-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.ability-increase-card {
  padding: 1.5rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  text-align: center;
  transition: all 0.3s;
}

.ability-increase-card:hover {
  background: rgba(10, 116, 218, 0.1);
  border-color: #00d9ff;
}

.ability-increase-card h4 {
  margin: 0 0 1rem 0;
  color: #00d9ff;
  font-size: 1.3rem;
  text-transform: uppercase;
}

.ability-current {
  display: flex;
  justify-content: space-between;
  margin-bottom: 1rem;
  padding: 0.5rem;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  font-size: 0.9rem;
}

.ability-increase-btn {
  width: 100%;
  padding: 0.75rem;
  margin-bottom: 0.5rem;
}

.ability-allocated {
  color: #00ff88;
  font-weight: bold;
  font-size: 1.1rem;
  margin-top: 0.5rem;
}

.ability-progress {
  text-align: center;
  padding: 1rem;
  background: rgba(0, 217, 255, 0.1);
  border: 2px solid #00d9ff;
  border-radius: 6px;
  margin-bottom: 1.5rem;
}

.ability-progress strong {
  color: #00d9ff;
  font-size: 1.2rem;
}

.feat-selection-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
  max-height: 400px;
  overflow-y: auto;
}

.feat-card {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  transition: all 0.3s;
}

.feat-card:hover {
  background: rgba(10, 116, 218, 0.2);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(10, 116, 218, 0.3);
}

.feat-card.selected {
  border-color: #00d966;
  background: rgba(0, 217, 102, 0.1);
}

.feat-card h4 {
  margin: 0 0 0.5rem 0;
  color: #00d9ff;
  font-size: 1rem;
}

.feat-description {
  font-size: 0.9rem;
  color: #e0e0e0;
  margin-bottom: 0.75rem;
  line-height: 1.4;
}

.feat-prereqs {
  font-size: 0.85rem;
  color: #ffc107;
  margin-bottom: 0.75rem;
  font-style: italic;
}

.selected-feats-display {
  padding: 1rem;
  background: rgba(0, 217, 102, 0.1);
  border-left: 4px solid #00d966;
  border-radius: 6px;
  margin-bottom: 1.5rem;
}

.selected-feats-display h4 {
  margin: 0 0 0.75rem 0;
  color: #00d966;
}

.selected-feat {
  padding: 0.5rem;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  margin-bottom: 0.5rem;
}

.talent-selection-intro {
  margin-bottom: 2rem;
}

.talent-intro-card {
  text-align: center;
  padding: 2rem;
  background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(10, 116, 218, 0.1) 100%);
  border: 3px solid #00d9ff;
  border-radius: 12px;
  margin-bottom: 2rem;
}

.talent-intro-icon {
  font-size: 4rem;
  color: #00d9ff;
  margin-bottom: 1rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.talent-intro-card h4 {
  color: #00d9ff;
  font-size: 1.6rem;
  margin: 0 0 1rem 0;
}

.talent-intro-card p {
  color: #aaa;
  margin: 0 0 1.5rem 0;
  font-size: 1rem;
}

.btn-primary-large {
  padding: 1rem 2rem;
  font-size: 1.2rem;
  font-weight: bold;
  background: linear-gradient(135deg, #0a74da 0%, #0056b3 100%);
  border: 2px solid #00d9ff;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 4px 15px rgba(10, 116, 218, 0.3);
}

.btn-primary-large:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0, 217, 255, 0.5);
  border-color: #00ffff;
}

.quick-tree-buttons {
  padding: 1.5rem;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  border: 1px dashed #0a74da;
}

.quick-select-label {
  text-align: center;
  color: #aaa;
  font-style: italic;
  margin: 0 0 1rem 0;
}

.talent-tree-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 1rem;
}

.selected-talent-display {
  padding: 1rem;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 6px;
  min-height: 80px;
  margin-bottom: 1.5rem;
}

.selected-talent-card {
  padding: 1.5rem;
  background: linear-gradient(135deg, rgba(0, 217, 102, 0.2) 0%, rgba(0, 168, 74, 0.2) 100%);
  border: 2px solid #00d966;
  border-radius: 8px;
  border-left-width: 5px;
}

.selected-talent-card i {
  color: #00d966;
  font-size: 1.5rem;
  margin-right: 0.5rem;
}

.selected-talent-card h4 {
  color: #00d966;
  margin: 0.5rem 0;
  font-size: 1.3rem;
}

.selected-talent-card p {
  margin: 0.5rem 0 0 0;
  color: #e4e4e4;
  line-height: 1.5;
}

.summary-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.summary-section {
  padding: 1rem;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 6px;
  border-left: 4px solid #00d9ff;
}

.summary-section h4 {
  margin: 0 0 0.5rem 0;
  color: #00d9ff;
}

.form-actions {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  margin-top: 2rem;
}

.btn-primary, .btn-secondary, .btn-success {
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  font-weight: bold;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-primary {
  background: linear-gradient(135deg, #0a74da 0%, #0056b3 100%);
  color: white;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(10, 116, 218, 0.4);
}

.btn-secondary {
  background: linear-gradient(135deg, #555 0%, #333 100%);
  color: white;
}

.btn-success {
  background: linear-gradient(135deg, #00d966 0%, #00a84a 100%);
  color: white;
}

.btn-success:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 217, 102, 0.4);
}

/* Species Selection Styles */
.species-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}

.species-card {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  transition: all 0.3s;
  text-align: center;
}

.species-card:hover {
  background: rgba(10, 116, 218, 0.2);
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(10, 116, 218, 0.3);
}

.species-card h5 {
  margin: 0 0 0.5rem 0;
  color: #00d9ff;
  font-size: 1.1rem;
}

.species-bonuses {
  margin-bottom: 1rem;
  font-size: 0.9rem;
  color: #aaa;
}

.bonus-label {
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: rgba(0, 217, 255, 0.1);
  border-radius: 4px;
  color: #00d9ff;
}

/* Abilities Mode Styles */
.ability-methods {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.method-button {
  padding: 0.75rem 1.5rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 6px;
  color: #fff;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.95rem;
}

.method-button:hover {
  background: rgba(10, 116, 218, 0.2);
  transform: translateY(-2px);
}

.method-button.active {
  background: rgba(10, 116, 218, 0.3);
  border-color: #00d9ff;
  box-shadow: 0 0 10px rgba(0, 217, 255, 0.4);
}

.ability-mode {
  margin-bottom: 2rem;
}

.points-remaining {
  text-align: center;
  padding: 1rem;
  background: rgba(0, 217, 255, 0.1);
  border: 2px solid #00d9ff;
  border-radius: 6px;
  margin-bottom: 1.5rem;
  font-size: 1.1rem;
}

.points-remaining strong {
  color: #00d9ff;
  font-size: 1.3rem;
}

.abilities-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
}

.ability-card {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid #0a74da;
  border-radius: 8px;
  text-align: center;
}

.ability-card label {
  display: block;
  color: #00d9ff;
  font-size: 1.1rem;
  font-weight: bold;
  margin-bottom: 0.75rem;
  text-transform: uppercase;
}

.ability-controls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.ability-btn {
  width: 32px;
  height: 32px;
  background: rgba(10, 116, 218, 0.3);
  border: 2px solid #0a74da;
  border-radius: 4px;
  color: #fff;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
}

.ability-btn:hover {
  background: rgba(10, 116, 218, 0.5);
  border-color: #00d9ff;
}

.ability-input {
  width: 60px;
  padding: 0.5rem;
  text-align: center;
  background: rgba(0, 0, 0, 0.3);
  border: 2px solid #0a74da;
  border-radius: 4px;
  color: #fff;
  font-size: 1.1rem;
  font-weight: bold;
}

.ability-display {
  color: #aaa;
  font-size: 0.85rem;
  margin-top: 0.5rem;
}

.roll-results {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 1rem;
  margin-bottom: 1rem;
}

.assign-roll {
  padding: 1rem 1.5rem;
  background: rgba(0, 217, 102, 0.2);
  border: 2px solid #00d966;
  border-radius: 6px;
  color: #fff;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
}

.assign-roll:hover {
  background: rgba(0, 217, 102, 0.3);
  transform: scale(1.1);
}

.organic-groups {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.organic-group {
  padding: 1rem;
  background: rgba(255, 170, 0, 0.2);
  border: 2px solid #ffa500;
  border-radius: 6px;
  color: #fff;
  font-size: 1.1rem;
  cursor: pointer;
  transition: all 0.3s;
  text-align: center;
}

.organic-group:hover {
  background: rgba(255, 170, 0, 0.3);
  transform: translateX(5px);
}

.organic-group.selected-group {
  background: rgba(0, 217, 255, 0.3);
  border-color: #00d9ff;
  box-shadow: 0 0 15px rgba(0, 217, 255, 0.5);
}
</style>
