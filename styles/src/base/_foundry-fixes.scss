// ============================================================================
// FOUNDRY VTT FIXES
// System-agnostic Foundry bug fixes (NOT scoped to .swse)
// These are necessary fixes for Foundry VTT issues
// ============================================================================

// ============================================
// ENHANCED SIDEBAR SPACE REMOVAL
// More specific selectors to override Foundry core
// ============================================

// Fix for Foundry v13/The Forge sidebar height bug
// Override broken height restrictions on sidebar tabs
#sidebar {
  // Ensure sidebar itself has proper display and sizing
  display: flex !important;
  flex-direction: column !important;
  height: 100% !important;
  padding-top: 0 !important;
  margin-top: 0 !important;

  // Remove ALL top spacing from sidebar tabs
  .sidebar-tab[data-tab] {
    height: auto !important;
    max-height: none !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    display: none !important; // Hidden by default
    padding-top: 0 !important;
    margin-top: 0 !important;

    // Show active tab
    &.active {
      display: flex !important;
      flex-direction: column !important;
      flex: 1 !important;
      min-height: 0 !important;
    }

    &.directory {
      height: auto !important;
      flex: 1 !important;
      min-height: 0 !important;
    }

    // Specific fixes for chat tab
    &#chat {
      padding-top: 0 !important;

      #chat-log {
        flex: 1 !important;
        min-height: 0 !important;
        overflow-y: auto !important;
        margin-top: 0 !important;
        padding-top: 15px !important;
      }

      #chat-controls {
        flex-shrink: 0 !important;
        margin-bottom: 0 !important;
      }

      #chat-form {
        flex-shrink: 0 !important;
      }
    }
  }

  // Specific tab content areas - more explicit targeting
  #chat-log,
  .directory-list,
  #combat-tracker,
  #scenes .directory-list,
  #actors .directory-list,
  #items .directory-list,
  #journal .directory-list,
  #tables .directory-list,
  #cards .directory-list,
  #playlists .directory-list,
  #compendium .directory-list {
    height: auto !important;
    max-height: none !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    flex: 1 !important;
    min-height: 0 !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
  }

  // Remove spacing from directory headers
  .directory-header,
  .directory-header.keep-collapsed {
    flex-shrink: 0 !important;
    margin-top: 0 !important;
    padding-top: 4px !important;
  }

  // Ensure search filters don't add space
  .directory-list .directory-header input[type="search"] {
    margin-top: 0 !important;
  }

  // Fix for sidebar tabs navigation
  nav.tabs {
    flex-shrink: 0 !important;
    margin-bottom: 0 !important;
  }
}

// ============================================
// LEFT TOOLBAR - REMOVE EDGE SPACING
// ============================================

#ui-left {
  display: flex !important;
  flex-direction: column !important;
  pointer-events: auto !important;
  padding-left: 0 !important;
  margin-left: 0 !important;
  left: 0 !important;
}

#controls {
  margin-left: 0 !important;
  padding-left: 0 !important;
  left: 0 !important;

  .scene-control,
  .control-tools {
    margin-left: 0 !important;
  }

  // Remove any gaps in the control buttons themselves
  ol.control-tools {
    padding-left: 0 !important;
    margin-left: 0 !important;
  }

  .scene-control {
    padding-left: 0 !important;
  }
}

// Add any other Foundry-specific fixes here as needed
// Keep this file minimal - only for fixing Foundry bugs
