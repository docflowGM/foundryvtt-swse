/* ==========================================
   SWSE UI Fix - Foundry V13 Compatible
   ==========================================
   Fixes layout issues without conflicting with core positioning
   - Forge VTT compatibility fixes
   - Restore Foundry default UI behavior
   - Fix window dragging and positioning
   - Prevent windows from rendering off-screen
*/

/* Wrap all fixes in the system layer for V13 CSS cascade layer compatibility */
@layer system {

/* ============================================
   CSS CUSTOM PROPERTIES (Safe to define)
   ============================================ */
:root {
    --swse-primary: #ffd700;
    --swse-background: rgba(0, 0, 0, 0.8);
    --swse-border: rgba(255, 215, 0, 0.3);

    /* Reference Foundry's variables where possible */
    --swse-sidebar-width: var(--sidebar-width, 300px);
    --swse-nav-height: var(--navigation-height, 32px);
    --swse-controls-width: 80px;
}

/* ============================================
   RESET PROBLEMATIC POSITIONING
   Remove any rules that offset core UI elements
   Only apply minimal resets - let Foundry/Forge handle positioning
   ============================================ */

/* DO NOT override core UI positioning with !important */
/* Foundry and Forge handle their own positioning */

/* Only ensure no unexpected transforms are applied by our system */
.swse {
    transform: none;
}

/* ============================================
   FORGE VTT BODY/HTML RESETS
   ============================================ */
/* REMOVED: These aggressive resets were conflicting with Forge's UI */
/* Let Foundry and Forge handle their own layout */

/* ============================================
   WINDOW POSITIONING CONSTRAINTS
   ============================================ */
/* Restore window functionality: draggable headers, resizable edges, proper centering */
.window-app, .dialog {
  /* Only apply minimal constraints - let Foundry handle positioning */
  position: absolute;
  /* Don't override z-index, max-width, or max-height - Foundry handles these */
}

.window-app.minimized {
  z-index: 90 !important;
}

.window-header {
  cursor: move !important;
}

.window-resizable-handle {
  display: block !important;
}

.window-app .window-content {
  overflow: auto !important;
}

/* Ensure SWSE-specific windows stay in bounds */
.window-app.swse {
    /* System styling - avoid position overrides */
    background: var(--swse-background);
    border: 1px solid var(--swse-border);
}

/* ============================================
   CONTEXT MENUS
   ============================================ */
/* Ensure context menus appear on top */
.context-menu {
  position: fixed !important;
  z-index: 10000 !important;
}

/* ============================================
   MOBILE / RESPONSIVE
   ============================================ */
/* Mobile / narrow-screen adjustments */
@media (max-width: 600px) {
  .window-app {
    width: 90% !important;
    max-width: 90vw !important;
  }
}

} /* End @layer system */
